2025-08-22 19:41:20,748 - config - INFO - Loaded tools from /workspace/mcp_servers/lightrag_mcp/config.yaml: ['query', 'documents_upload_file', 'documents_insert_text', 'documents_scan', 'documents_upload_files', 'graphs_get', 'graph_labels', 'graph_entity_exists', 'graph_update_entity', 'graph_update_relation', 'documents_pipeline_status', 'documents_delete_entity', 'documents_delete_relation']
2025-08-22 19:41:20,755 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
2025-08-22 19:41:20,770 - INFO - Processing request of type ListToolsRequest
Secure MCP Filesystem Server running on stdio
Client does not support MCP Roots, using allowed directories set from server args: [ '/workspace/knowledge_agent', '/workspace/LightRAG' ]
Successfully loaded 32 tools from MCP server.


[1m> Entering new None chain...[0m
[32;1m[1;3m
Invoking: `load_report` with `{'filename': 'latest_analyst_report.json'}`


[0m[33;1m[1;3mNo report found.[0m[32;1m[1;3m
Invoking: `researcher_agent` with ` `


[0m

[1m> Entering new AgentExecutor chain...[0m
Traceback (most recent call last):
  File "/workspace/knowledge_agent/run.py", line 93, in <module>
    asyncio.run(main())
  File "/home/filip/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/home/filip/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/filip/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/workspace/knowledge_agent/run.py", line 84, in main
    async for chunk in knowledge_agent.astream(
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain/agents/agent.py", line 1827, in astream
    async for step in iterator:
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain/agents/agent_iterator.py", line 268, in __aiter__
    async for chunk in self.agent_executor._aiter_next_step(
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain/agents/agent.py", line 1546, in _aiter_next_step
    result = await asyncio.gather(
             ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain/agents/agent.py", line 1584, in _aperform_agent_action
    observation = await tool.arun(
                  ^^^^^^^^^^^^^^^^
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/tools/base.py", line 1001, in arun
    raise error_to_raise
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/tools/base.py", line 970, in arun
    response = await coro_with_context(coro, context)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/tools/simple.py", line 122, in _arun
    return await self.coroutine(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/knowledge_agent/sub_agents.py", line 28, in ainvoke_wrapper
    return await agent_executor.ainvoke({"input": input_data})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain/chains/base.py", line 220, in ainvoke
    await self._acall(inputs, run_manager=run_manager)
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain/agents/agent.py", line 1681, in _acall
    next_step_output = await self._atake_next_step(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain/agents/agent.py", line 1463, in _atake_next_step
    [
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain/agents/agent.py", line 1491, in _aiter_next_step
    output = await self._action_agent.aplan(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain/agents/agent.py", line 612, in aplan
    async for chunk in self.runnable.astream(
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 3467, in astream
    async for chunk in self.atransform(input_aiter(), config, **kwargs):
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 3449, in atransform
    async for chunk in self._atransform_stream_with_config(
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 2320, in _atransform_stream_with_config
    chunk = await coro_with_context(py_anext(iterator), context)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 3416, in _atransform
    async for output in final_pipeline:
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 1472, in atransform
    async for ichunk in input:
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 5670, in atransform
    async for item in self.bound.atransform(
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 1472, in atransform
    async for ichunk in input:
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 1490, in atransform
    async for output in self.astream(final, config, **kwargs):
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 1035, in astream
    yield await self.ainvoke(input, config, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/prompts/base.py", line 242, in ainvoke
    return await self._acall_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 1989, in _acall_with_config
    output: Output = await coro_with_context(coro, context)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/prompts/base.py", line 195, in _aformat_prompt_with_error_handling
    inner_input_ = self._validate_input(inner_input)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/knowledge_agent/.venv/lib/python3.12/site-packages/langchain_core/prompts/base.py", line 183, in _validate_input
    raise KeyError(
KeyError: "Input to ChatPromptTemplate is missing variables {'timestamp'}.  Expected: ['input', 'timestamp'] Received: ['input', 'intermediate_steps', 'agent_scratchpad']\nNote: if you intended {timestamp} to be part of the string and not a variable, please escape it with double curly braces like: '{{timestamp}}'.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_PROMPT_INPUT "
